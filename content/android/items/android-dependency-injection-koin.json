{
  "title": "Koin",
  "content": [
    {
      "type": "text",
      "value": "**Koin** ‚Äî —ç—Ç–æ –ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (**Dependency Injection, DI**) –¥–ª—è —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è Kotlin, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –ø–æ–¥ Android. –û–Ω–∞ —É–ø—Ä–æ—â–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –ø–æ–∑–≤–æ–ª—è—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, –∫–∞–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å—Å—è –¥—Ä—É–≥–∏–º —á–∞—Å—Ç—è–º –ø—Ä–æ–≥—Ä–∞–º–º—ã. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç –∏—Ö —É Koin, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ —á–∏—â–µ –∏ –ø—Ä–æ—â–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫–µ."
    },
    {
      "type": "text",
      "value": "**Koin** ‚Äî —ç—Ç–æ pure-Kotlin DI-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫, –∫–æ—Ç–æ—Ä—ã–π **—Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** (runtime), –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç **Hilt**, –∫–æ—Ç–æ—Ä—ã–π **—Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏**."
    },
    {
      "type": "text",
      "value": "#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:\n\n**–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏–∑—É—á–µ–Ω–∏—è**\n\n- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–æ–π–ª–µ—Ä–ø–ª–µ–π—Ç\n\n- –ù–µ—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –Ω–∞ –∫–ª–∞—Å—Å–∞—Ö\n\n- –ù–µ—Ç –∫–æ–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏\n\n- –ú–µ–Ω—å—à–µ —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏\n\n**Pure Kotlin**\n\n- –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Kotlin DSL\n\n- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —è–∑—ã–∫–∞, –∞ –Ω–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π\n\n- –õ—É—á—à–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Kotlin-—Ñ–∏—á–∞–º–∏\n\n**–ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è**\n\n- –ù–µ—Ç –∫–æ–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ = –±—ã—Å—Ç—Ä–µ–µ —Å–±–æ—Ä–∫–∞\n\n- –û—Å–æ–±–µ–Ω–Ω–æ –∑–∞–º–µ—Ç–Ω–æ –≤ –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö\n\n**–ì–∏–±–∫–æ—Å—Ç—å**\n\n- –õ–µ–≥–∫–æ –ø–æ–¥–º–µ–Ω—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ runtime\n\n- –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–±–æ—Ä–æ–∫"
    },
    {
      "type": "text",
      "value": "### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:"
    },
    {
      "type": "text",
      "value": "**libs.versions.toml**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "[versions]\n. . .\nkoinAndroid = \"4.1.1\"\nkoinAndroidxCompose = \"4.1.1\"\nkoinAndroidxWorkmanager = \"4.1.1\"\nkoinTest = \"4.1.1\"\nkoinTestJunit4 = \"4.1.1\"\n\n[libraries]\n. . .\nkoin-android = { module = \"io.insert-koin:koin-android\", version.ref = \"koinAndroid\" }\nkoin-androidx-compose = { module = \"io.insert-koin:koin-androidx-compose\", version.ref = \"koinAndroidxCompose\" }\nkoin-androidx-workmanager = { module = \"io.insert-koin:koin-androidx-workmanager\", version.ref = \"koinAndroidxWorkmanager\" }\nkoin-test = { module = \"io.insert-koin:koin-test\", version.ref = \"koinTest\" }\nkoin-test-junit4 = { module = \"io.insert-koin:koin-test-junit4\", version.ref = \"koinTestJunit4\" }"
    },
    {
      "type": "text",
      "value": "**App-level** build.gradle.kts:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "dependencies {\n    // –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Koin\n    implementation(libs.koin.android)\n\n    // –î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Jetpack Compose\n    implementation(libs.koin.androidx.compose)\n\n    // –î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ ViewModel\n    implementation(libs.koin.androidx.workmanager)\n\n    // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è\n    testImplementation(libs.koin.test)\n    testImplementation(libs.koin.test.junit4)\n}"
    },
    {
      "type": "text",
      "value": "#### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:\n\n**Application** –∫–ª–∞—Å—Å:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class MyApplication : Application() {\n    override fun onCreate() {\n        super.onCreate()\n        \n        startKoin {\n            // –ö–æ–Ω—Ç–µ–∫—Å—Ç Android\n            androidContext(this@MyApplication)\n            \n            // –ú–æ–¥—É–ª–∏\n            modules(appModule, networkModule, repositoryModule)\n            \n            // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)\n            androidLogger(Level.ERROR)\n        }\n    }\n}"
    },
    {
      "type": "text",
      "value": "### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Koin:"
    },
    {
      "type": "text",
      "value": "#### Module - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val appModule = module {\n    // –ó–¥–µ—Å—å –æ–ø–∏—Å—ã–≤–∞–µ–º –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏\n}"
    },
    {
      "type": "text",
      "value": "### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:\n\n`single` - –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞ –≤—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "single { \n    Retrofit.Builder().build() \n}\n// –ê–Ω–∞–ª–æ–≥ @Singleton –≤ Hilt"
    },
    {
      "type": "text",
      "value": "`factory` - –Ω–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "factory { \n    UserAdapter() \n}\n// –ù–æ–≤—ã–π –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–∫—Ä–∞–Ω–∞"
    },
    {
      "type": "text",
      "value": "`viewModel` - —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è ViewModel"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "viewModel { \n    UserViewModel(get()) \n}\n// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ –∂–∏–∑–Ω–µ–Ω–Ω–æ–º—É —Ü–∏–∫–ª—É"
    },
    {
      "type": "text",
      "value": "### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π"
    },
    {
      "type": "text",
      "value": "`get()` - —è–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π\n\n`singleOf()` - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥\n\n`bind` - –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤"
    },
    {
      "type": "text",
      "value": "`get()` - —è–≤–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (—Å–∞–º—ã–π —á–∞—Å—Ç—ã–π)\n\n**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —è–≤–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val module = module {\n    viewModel { \n        UserViewModel(\n            repository = get(),  // –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å\n            analytics = get()    // –ï—â–µ –æ–¥–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å\n        )\n    }\n}"
    },
    {
      "type": "text",
      "value": "`singleOf(::Constructor)` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ\n\n**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –î–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ Koin"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val module = module {\n    singleOf(::UserRepository)  // Koin –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞\n    \n    singleOf(::ApiService)      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç Retrofit\n}"
    },
    {
      "type": "text",
      "value": "`bind` - –ø—Ä–∏–≤—è–∑–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val module = module {\n    singleOf(::FirebaseAnalytics) bind AnalyticsService::class\n    // –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ inject –∫–∞–∫ AnalyticsService\n}"
    },
    {
      "type": "text",
      "value": "### –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:"
    },
    {
      "type": "text",
      "value": "**Constructor injection** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class UserRepository(\n    private val api: ApiService,  // Koin –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç ApiService\n    private val db: Database\n)"
    },
    {
      "type": "text",
      "value": "**Property injection** —á–µ—Ä–µ–∑ `by inject()`"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class MainActivity : AppCompatActivity() {\n    // Lazy injection\n    private val userRepository by inject<UserRepository>()\n    private val analytics by inject<AnalyticsService>()\n}"
    },
    {
      "type": "text",
      "value": "**–ü—Ä—è–º–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑** `get()`"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val userRepository: UserRepository = get()"
    },
    {
      "type": "text",
      "value": "### –ö–ª—é—á–µ–≤—ã–µ DSL —Ñ—É–Ω–∫—Ü–∏–∏:"
    },
    {
      "type": "text",
      "value": "`get()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "single { \n    UserRepository(get()) // Koin –Ω–∞–π–¥–µ—Ç ApiService \n}\n\nsingle {\n    ApiService(get()) // Koin –Ω–∞–π–¥–µ—Ç Retrofit\n}"
    },
    {
      "type": "text",
      "value": "`bind` - –ø—Ä–∏–≤—è–∑–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "single<ApiService> { \n    RetrofitApiService() \n} bind ApiService::class"
    },
    {
      "type": "text",
      "value": "`named` - –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val apiModule = module {\n    single(named(\"prod\")) { \n        Retrofit.Builder().baseUrl(\"https://api.com\").build() \n    }\n    \n    single(named(\"dev\")) { \n        Retrofit.Builder().baseUrl(\"https://dev.api.com\").build() \n    }\n}\n\n// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ\nclass Repository(\n    @Named(\"prod\") private val retrofit: Retrofit\n)"
    },
    {
      "type": "text",
      "value": "###  Scope –≤ Koin:"
    },
    {
      "type": "text",
      "value": "**–°–æ–∑–¥–∞–Ω–∏–µ scope:**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "// Session scope –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Å–µ—Å—Å–∏–∏\nval sessionModule = module {\n    scope<SessionActivity> {\n        scoped { UserSession() } // –ñ–∏–≤–µ—Ç –ø–æ–∫–∞ –∂–∏–≤ scope\n    }\n}"
    },
    {
      "type": "text",
      "value": "**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ scope:**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class SessionActivity : AppCompatActivity() {\n    private val sessionScope = getKoin().getOrCreateScope(\"session\", named<SessionActivity>())\n    private val userSession: UserSession by sessionScope.inject()\n    \n    override fun onDestroy() {\n        sessionScope.close()\n        super.onDestroy()\n    }\n}"
    },
    {
      "type": "text",
      "value": "### Koin + ViewModel + Compose"
    },
    {
      "type": "text",
      "value": "**ViewModel**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class CounterViewModel : ViewModel() {\n    private val _count = MutableStateFlow(0)\n    val count = _count.asStateFlow()\n    \n    fun increment() {\n        _count.value += 1\n    }\n    \n    fun decrement() {\n        _count.value -= 1\n    }\n}"
    },
    {
      "type": "text",
      "value": "**–ú–æ–¥—É–ª—å Koin**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val appModule = module {\n    viewModel { CounterViewModel() }\n}"
    },
    {
      "type": "text",
      "value": "**Application**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class MyApp : Application() {\n    override fun onCreate() {\n        super.onCreate()\n        startKoin {\n            androidContext(this@MyApp)\n            modules(appModule)\n        }\n    }\n}"
    },
    {
      "type": "text",
      "value": "**Compose Screen**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "@Composable\nfun CounterScreen(\n    viewModel: CounterViewModel = koinViewModel()  // üîë –ú–∞–≥–∏—è Koin!\n) {\n    val count by viewModel.count.collectAsStateWithLifecycle()\n    \n    Column(\n        modifier = Modifier\n            .fillMaxSize()\n            .padding(16.dp),\n        horizontalAlignment = Alignment.CenterHorizontally,\n        verticalArrangement = Arrangement.Center\n    ) {\n        Text(\n            text = \"–°—á–µ—Ç—á–∏–∫: $count\",\n            style = MaterialTheme.typography.headlineMedium,\n            modifier = Modifier.padding(16.dp)\n        )\n        \n        Row(\n            horizontalArrangement = Arrangement.spacedBy(16.dp)\n        ) {\n            Button(onClick = { viewModel.decrement() }) {\n                Text(\"-1\")\n            }\n            \n            Button(onClick = { viewModel.increment() }) {\n                Text(\"+1\")\n            }\n        }\n    }\n}"
    },
    {
      "type": "text",
      "value": "**Activity**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class MainActivity : ComponentActivity() {\n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        setContent {\n            CounterScreen()  // üîë ViewModel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–Ω–µ–¥—Ä—è–µ—Ç—Å—è!\n        }\n    }\n}"
    },
    {
      "type": "text",
      "value": "- **Koin —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç** CounterViewModel –≤ –º–æ–¥—É–ª–µ\n\n- **Compose —Ñ—É–Ω–∫—Ü–∏—è** –≤—ã–∑—ã–≤–∞–µ—Ç koinViewModel()\n\n- **Koin –Ω–∞—Ö–æ–¥–∏—Ç** –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ViewModel\n\n- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ** - ViewModel –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ Composable"
    },
    {
      "type": "text",
      "value": "### –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:"
    },
    {
      "type": "text",
      "value": "**1. Data Layer**"
    },
    {
      "type": "text",
      "value": "–ß—Ç–æ –∑–¥–µ—Å—å –≤–∞–∂–Ω–æ –¥–ª—è Koin:\n\n- –≠—Ç–∏ –∫–ª–∞—Å—Å—ã **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Koin –Ω–∞–ø—Ä—è–º—É—é**\n\n- Koin –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ–º AppDatabase —á–µ—Ä–µ–∑ –º–æ–¥—É–ª—å\n\n- UserDao –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ AppDatabase, –ø–æ—ç—Ç–æ–º—É Koin —Ç–æ–∂–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏–º"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "// Entity - –æ–±—ã—á–Ω–∞—è data class, –Ω–∏–∫–∞–∫–æ–π –º–∞–≥–∏–∏ Koin\n@Entity\ndata class User(\n    @PrimaryKey val id: Int,\n    val name: String,\n    val email: String\n)\n\n// DAO - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, Room —Å–∞–º –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é\n@Dao\ninterface UserDao {\n    @Query(\"SELECT * FROM user\")\n    suspend fun getUsers(): List<User>\n    \n    @Insert\n    suspend fun insertUser(user: User)\n}\n\n// Database - –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–ª–∞—Å—Å, Room –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é\n@Database(entities = [User::class], version = 1)\nabstract class AppDatabase : RoomDatabase() {\n    abstract fun userDao(): UserDao\n    // Koin –ù–ï —Å–æ–∑–¥–∞–µ—Ç —ç—Ç–æ—Ç –∫–ª–∞—Å—Å –Ω–∞–ø—Ä—è–º—É—é!\n    // –û–Ω —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ databaseModule\n}"
    },
    {
      "type": "text",
      "value": "**2. Network Layer**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è Retrofit - Retrofit —Å–∞–º —Å–æ–∑–¥–∞–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é\ninterface ApiService {\n    @GET(\"users\")\n    suspend fun getUsers(): List<User>\n}\n// Koin –ù–ï —Å–æ–∑–¥–∞–µ—Ç —ç—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞–ø—Ä—è–º—É—é!\n// –û–Ω —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ networkModule"
    },
    {
      "type": "text",
      "value": "**3. Repository**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class UserRepository(\n    private val apiService: ApiService,    // Koin –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç ApiService\n    private val userDao: UserDao          // Koin –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç UserDao\n) {\n    suspend fun getUsers(): List<User> {\n        val networkUsers = apiService.getUsers()  // –ò—Å–ø–æ–ª—å–∑—É–µ–º ApiService\n        userDao.insertUser(networkUsers)          // –ò—Å–ø–æ–ª—å–∑—É–µ–º UserDao\n        return userDao.getUsers()\n    }\n}\n// –ö–æ–≥–¥–∞ Koin –≤–∏–¥–∏—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, –æ–Ω –ø–æ–Ω–∏–º–∞–µ—Ç:\n// \"–ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å UserRepository, –º–Ω–µ –Ω—É–∂–Ω—ã ApiService –∏ UserDao\"\n// Koin –∏—â–µ—Ç –≤ —Å–≤–æ–∏—Ö –º–æ–¥—É–ª—è—Ö, –∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å —ç—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏\n// –ù–ò–ö–ê–ö–ò–• –ê–ù–ù–û–¢–ê–¶–ò–ô! Koin —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ —Ä–µ—Ñ–ª–µ–∫—Å–∏—é"
    },
    {
      "type": "text",
      "value": "**4. Modules - –°–µ—Ä–¥—Ü–µ koin**"
    },
    {
      "type": "text",
      "value": "DatabaseModule:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "// –û–±—ä–µ–∫—Ç –º–æ–¥—É–ª—è\nval databaseModule = module {\n    // single = —Å–æ–∑–¥–∞–π —Ç–æ–ª—å–∫–æ –û–î–ò–ù —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞ –≤—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ\n    single { \n        Room.databaseBuilder(\n            androidApplication(),  // Koin –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç Context\n            AppDatabase::class.java,\n            \"app.db\"\n        ).build()\n    }\n    \n    // factory = —Å–æ–∑–¥–∞–≤–∞–π –Ω–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ\n    // –ù–û –∑–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º single, —Ç.–∫. database.userDao() –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ—Ç –∂–µ —ç–∫–∑–µ–º–ø–ª—è—Ä\n    single { \n        get<AppDatabase>().userDao()  // get() = \"–Ω–∞–π–¥–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Ç–∏–ø–∞ AppDatabase\"\n    }\n    // Koin –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞—Å—Ç AppDatabase, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Å–æ–∑–¥–∞–ª–∏ –≤—ã—à–µ\n}"
    },
    {
      "type": "text",
      "value": "NetworkModule:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val networkModule = module {\n    // single = Retrofit - —Ç—è–∂–µ–ª—ã–π –æ–±—ä–µ–∫—Ç, —Å–æ–∑–¥–∞–π –µ–≥–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑\n    single {\n        Retrofit.Builder()\n            .baseUrl(\"https://jsonplaceholder.typicode.com/\")\n            .addConverterFactory(GsonConverterFactory.create())\n            .build()\n    }\n    \n    // single = ApiService, —Ç.–∫. retrofit.create() –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π, –Ω–æ –º—ã —Ö–æ—Ç–∏–º –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä\n    single {\n        get<Retrofit>().create(ApiService::class.java)\n    }\n    // Koin –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞—Å—Ç Retrofit, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Å–æ–∑–¥–∞–ª–∏ –≤—ã—à–µ\n}"
    },
    {
      "type": "text",
      "value": "RepositoryModule:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val repositoryModule = module {\n    // single = UserRepository —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ –≤—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ\n    single { \n        UserRepository(\n            apiService = get(),  // Koin –Ω–∞–π–¥–µ—Ç ApiService\n            userDao = get()      // Koin –Ω–∞–π–¥–µ—Ç UserDao\n        )\n    }\n}"
    },
    {
      "type": "text",
      "value": "**5. ViewModel**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class UserViewModel(\n    private val userRepository: UserRepository  // Koin –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç UserRepository\n) : ViewModel() {\n    // Koin —Å–æ–∑–¥–∞–µ—Ç ViewModel —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é —Ñ–∞–±—Ä–∏–∫—É\n    // –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç ViewModel –ø–µ—Ä–µ–∂–∏–≤–∞—Ç—å —Å–º–µ–Ω—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏\n    \n    private val _users = MutableStateFlow<List<User>>(emptyList())\n    val users: StateFlow<List<User>> = _users.asStateFlow()\n    \n    private val _isLoading = MutableStateFlow(false)\n    val isLoading: StateFlow<Boolean> = _isLoading.asStateFlow()\n    \n    fun loadUsers() {\n        viewModelScope.launch {\n            _isLoading.value = true\n            try {\n                // –ò—Å–ø–æ–ª—å–∑—É–µ–º UserRepository, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª Koin\n                _users.value = userRepository.getUsers()\n            } catch (e: Exception) {\n                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫\n            } finally {\n                _isLoading.value = false\n            }\n        }\n    }\n}"
    },
    {
      "type": "text",
      "value": "ViewModel Module:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val viewModelModule = module {\n    // viewModel = —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è ViewModel\n    viewModel { \n        UserViewModel(get())  // Koin –Ω–∞–π–¥–µ—Ç UserRepository\n    }\n}"
    },
    {
      "type": "text",
      "value": "**6. Activity**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class MainActivity : AppCompatActivity() {\n    \n    // by viewModel() - Koin –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç ViewModel\n    private val viewModel: UserViewModel by viewModel()\n    // –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º Koin –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ—é —Ñ–∞–±—Ä–∏–∫—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è ViewModel\n    // —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ (UserRepository)\n    \n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        setContentView(R.layout.activity_main)\n        \n        setupObservers()\n        viewModel.loadUsers()  // –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö\n    }\n    \n    private fun setupObservers() {\n        lifecycleScope.launch {\n            repeatOnLifecycle(Lifecycle.State.STARTED) {\n                // –°–ª–µ–¥–∏–º –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π\n                viewModel.users.collect { users ->\n                    updateUserList(users)  // –û–±–Ω–æ–≤–ª—è–µ–º UI\n                }\n            }\n        }\n        \n        lifecycleScope.launch {\n            repeatOnLifecycle(Lifecycle.State.STARTED) {\n                // –°–ª–µ–¥–∏–º –∑–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∑–∞–≥—Ä—É–∑–∫–∏\n                viewModel.isLoading.collect { isLoading ->\n                    progressBar.isVisible = isLoading  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä\n                }\n            }\n        }\n    }\n}"
    },
    {
      "type": "text",
      "value": "**7. Application**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class MyApplication : Application() {\n    override fun onCreate() {\n        super.onCreate()\n        \n        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Koin\n        startKoin {\n            // Android –∫–æ–Ω—Ç–µ–∫—Å—Ç\n            androidContext(this@MyApplication)\n            \n            // –í—Å–µ –º–æ–¥—É–ª–∏\n            modules(\n                databaseModule,\n                networkModule, \n                repositoryModule,\n                viewModelModule\n            )\n            \n            // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)\n            androidLogger(Level.ERROR)\n        }\n    }\n}"
    },
    {
      "type": "text",
      "value": "AndroidManifest.xml:"
    },
    {
      "type": "code",
      "language": "xml",
      "value": "<application\n    android:name=\".MyApplication\"\n    ...>\n</application>"
    },
    {
      "type": "text",
      "value": "#### –ü–æ–ª–Ω—ã–π –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Koin"
    },
    {
      "type": "image",
      "src": "/images/android/android_dependency_injection_koin_example.png",
      "alt": "–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã Koin",
      "caption": "–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã Koin"
    },
    {
      "type": "text",
      "value": "#### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:\n\n- **–°—Ç–∞—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** ‚Üí `startKoin` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π\n\n\n\n- **Koin —Å–æ–∑–¥–∞–µ—Ç** `Retrofit` –∏ `AppDatabase` (—Ç—è–∂–µ–ª—ã–µ –æ–±—ä–µ–∫—Ç—ã, –æ–¥–∏–Ω —Ä–∞–∑ - `single`)\n\n\n\n- **–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏** `UserRepository` ‚Üí Koin –ø–µ—Ä–µ–¥–∞–µ—Ç –µ–º—É `ApiService` –∏ `UserDao`\n\n\n\n- **–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏** `UserViewModel` ‚Üí Koin –ø–µ—Ä–µ–¥–∞–µ—Ç –µ–º—É `UserRepository`\n\n\n\n- **–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏** `MainActivity` ‚Üí Koin –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–æ—Ç–æ–≤—ã–π `UserViewModel` —á–µ—Ä–µ–∑ `by viewModel()`"
    },
    {
      "type": "text",
      "value": "#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:\n\n- **–ú–∏–Ω–∏–º—É–º –±–æ–π–ª–µ—Ä–ø–ª–µ–π—Ç–∞** - –Ω–µ—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –Ω–∞ –∫–∞–∂–¥–æ–º –∫–ª–∞—Å—Å–µ\n\n- **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–π DSL\n\n- **–ì–∏–±–∫–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –º–µ–Ω—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ runtime\n\n- **Kotlin-first** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ Kotlin"
    },
    {
      "type": "text",
      "value": "**Koin** –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç **–±–æ–ª–µ–µ –ª–µ–≥–∫–∏–π –∏ Kotlin-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π** –ø–æ–¥—Ö–æ–¥ –∫ DI –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å Hilt!"
    }
  ]
}