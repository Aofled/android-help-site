{
  "title": "Жизненный цикл Activity (Activity lifecycle)",
  "content": [
    {
      "type": "text",
      "value": "**Activity** — это ключевой компонент Android-приложений, представляющий собой один экран с пользовательским интерфейсом.\n\n**Activity** проходит через несколько состояний, управляемых системой:"
    },
    {
      "type": "image",
      "src": "/images/android/android_activity_lifecycle.png",
      "alt": "Жизненный цикл Activity",
      "caption": "Жизненный цикл Activity"
    },
    {
      "type": "text",
      "value": "**Состояние:**\t**Описание:**\n\n**Created**\tActivity создана, но не видна.\n\n**Started**\tActivity видна, но не в фокусе (например, под прозрачным окном).\n\n**Resumed**\tActivity на переднем плане и взаимодействует с пользователем (в фокусе).\n\n**Paused**\tЧастично видна (например, при полупрозрачном диалоге).\n\n**Stopped**\tПолностью скрыта (например, перешли в другую Activity).\n\n**Destroyed**\tActivity уничтожена системой или завершена."
    },
    {
      "type": "text",
      "value": "### Методы жизненного цикла:"
    },
    {
      "type": "text",
      "value": "#### onCreate() — Создание Activity"
    },
    {
      "type": "text",
      "value": "Вызывается **первым** при создании Activity.\n\n\n\nЗдесь инициализируются:\n\n\n\n- UI (setContentView())\n\n\n\n- Данные\n\n\n\n- ViewModel\n\n\n\n- Подписки (но не долгоживущие!)"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onCreate(savedInstanceState: Bundle?) {\n    super.onCreate(savedInstanceState)\n    setContentView(R.layout.activity_main)\n    \n    // Восстановление данных после поворота экрана\n    val username = savedInstanceState?.getString(\"USERNAME\") ?: \"\"\n}"
    },
    {
      "type": "text",
      "value": "#### onStart() — Старт видимости"
    },
    {
      "type": "text",
      "value": "Activity **становится видимой**, но ещё не взаимодействует с пользователем.\n\n\n\nЧасто используют для:\n\n\n\n-  Запуска анимаций\n\n\n\n- Подключения к сервисам"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onStart() {\n    super.onStart()\n    // Например, запуск анимации\n    imageView.startAnimation(animation)\n}"
    },
    {
      "type": "text",
      "value": "#### onResume() — Активность на переднем плане"
    },
    {
      "type": "text",
      "value": "Activity теперь в **фокусе** и готова к взаимодействию.\n\n\n\nЗдесь:\n\n\n\n- Запускают камеру, GPS\n\n\n\n- Возобновляют анимации\n\n\n\n- Обновляют данные (если изменились за время onPause)"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onResume() {\n    super.onResume()\n    // Обновление данных с сервера\n    viewModel.loadFreshData()\n}"
    },
    {
      "type": "text",
      "value": "#### onPause() — Частичное скрытие"
    },
    {
      "type": "text",
      "value": "Вызывается, когда Activity **теряет фокус** (но ещё частично видна).\n\n\n\nЗдесь:\n\n\n\n- Сохраняют данные\n\n\n\n- Останавливают тяжёлые операции\n\n\n\n- Освобождают ресурсы (камеру, сенсоры)"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onPause() {\n    super.onPause()\n    // Сохранение данных в SharedPreferences\n    pref.edit().putInt(\"SCORE\", score).apply()\n}"
    },
    {
      "type": "text",
      "value": "#### onStop() — Полное скрытие"
    },
    {
      "type": "text",
      "value": "Activity больше **не видна** (например, пользователь перешёл в другое приложение).\n\n\n\nЗдесь:\n\n\n\n- Отписываются от событий\n\n\n\n- Останавливают фоновые задачи"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onStop() {\n    super.onStop()\n    // Отмена подписки на обновления местоположения\n    locationManager.removeUpdates(locationListener)\n}"
    },
    {
      "type": "text",
      "value": "#### onDestroy() — Уничтожение Activity"
    },
    {
      "type": "text",
      "value": "Вызывается перед уничтожением Activity.\n\n\n\nПричины:\n\n\n\n- Явный вызов finish()\n\n\n\n- Система убивает процесс (например, при нехватке памяти)"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onDestroy() {\n    super.onDestroy()\n    // Очистка ресурсов (например, закрытие базы данных)\n    database.close()\n}"
    },
    {
      "type": "text",
      "value": "#### onRestart() — Перед повторным запуском"
    },
    {
      "type": "text",
      "value": "Вызывается, если Activity возвращается из состояния Stopped (но не Destroyed)."
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onRestart() {\n    super.onRestart()\n    // Обновление данных, если приложение было свёрнуто\n    refreshData()\n}"
    },
    {
      "type": "text",
      "value": "#### onSaveInstanceState() — Сохранение состояния"
    },
    {
      "type": "text",
      "value": "Вызывается перед **onStop()**, если система может убить процесс.\n\n\n\n- Сохраняет временные данные (например, текст в EditText)."
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onSaveInstanceState(outState: Bundle) {\n    super.onSaveInstanceState(outState)\n    outState.putString(\"EDIT_TEXT\", editText.text.toString())\n}"
    },
    {
      "type": "text",
      "value": "#### onRestoreInstanceState() — Восстановление состояния"
    },
    {
      "type": "text",
      "value": "Вызывается после **onStart()**, если Activity воссоздаётся (например, после поворота экрана)."
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onRestoreInstanceState(savedInstanceState: Bundle) {\n    super.onRestoreInstanceState(savedInstanceState)\n    val text = savedInstanceState.getString(\"EDIT_TEXT\")\n    editText.setText(text)\n}"
    }
  ]
}