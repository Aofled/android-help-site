{
  "title": "Жизненный цикл Activity (Activity lifecycle)",
  "content": [
    {
      "type": "image",
      "src": "/images/android/android_activity_lifecycle.png",
      "alt": "Жизненный цикл Activity",
      "caption": "Жизненный цикл Activity"
    },
    {
      "type": "text",
      "value": "**Состояние:**\t**Описание:**\n\n**Created**\tActivity создана, но не видна.\n\n**Started**\tActivity видна, но не в фокусе (например, под прозрачным окном).\n\n**Resumed**\tActivity на переднем плане и взаимодействует с пользователем (в фокусе).\n\n**Paused**\tЧастично видна (например, при полупрозрачном диалоге).\n\n**Stopped**\tПолностью скрыта (например, перешли в другую Activity).\n\n**Destroyed**\tActivity уничтожена системой или завершена."
    },
    {
      "type": "text",
      "value": "### Методы жизненного цикла:"
    },
    {
      "type": "text",
      "value": "**onCreate()**"
    },
    {
      "type": "text",
      "value": "**Вызывается** при первом создании Activity\n\n\n\n**Обязательный метод**: здесь задается layout через **setContentView()**\n\n\n\n**Идеальное место** для:\n\n\n\n- Инициализации UI\n\n\n\n- Настройки ViewModel\n\n\n\n- Восстановления состояния"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onCreate(savedInstanceState: Bundle?) {\n    super.onCreate(savedInstanceState)\n    setContentView(R.layout.activity_main)\n    \n    // Восстановление состояния после поворота экрана\n    val savedText = savedInstanceState?.getString(\"KEY_TEXT\")\n    // Инициализация UI компонентов\n    button.setOnClickListener { /* ... */ }\n}"
    },
    {
      "type": "text",
      "value": "**onRestart()**"
    },
    {
      "type": "text",
      "value": "Специальный метод, вызываемый перед **onStart()**, если Activity возвращается из stopped состояния"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onRestart() {\n    super.onRestart()\n    // Обновление данных, которые могли измениться, пока Activity была неактивна\n    updateUserStatus()\n}"
    },
    {
      "type": "text",
      "value": "**onStart()**"
    },
    {
      "type": "text",
      "value": "Activity становится видимой, но еще не в фокусе\n\nПодходящее место для:\n\n- Регистрации BroadcastReceiver\n\n- Запуска анимаций"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onStart() {\n    super.onStart()\n    // Регистрация слушателей, которые должны работать, когда Activity видима\n    sensorManager.registerListener(this, accelerometer, SensorManager.SENSOR_DELAY_NORMAL)\n}"
    },
    {
      "type": "text",
      "value": "**onResume()**"
    },
    {
      "type": "text",
      "value": "Activity выходит на передний план и готова к взаимодействию\n\nЗдесь активируют:\n\n- Камеру\n\n- Анимации\n\n- Обновление данных (если они могли устареть)"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onResume() {\n    super.onResume()\n    // Возобновление анимации\n    animation.start()\n    // Обновление данных\n    viewModel.refreshData()\n}"
    },
    {
      "type": "text",
      "value": "**onPause()**"
    },
    {
      "type": "text",
      "value": "Вызывается при частичном закрытии Activity (например, появлении диалога)\n\n**Важно**: не выполняйте долгие операции — это замедлит переход!\n\nЗдесь следует:\n\n- Сохранять данные\n\n- Освобождать ресурсы (камеру)"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onPause() {\n    super.onPause()\n    // Сохранение данных\n    preferences.edit().putString(\"AUTO_SAVE\", editText.text.toString()).apply()\n    // Приостановка анимации\n    animation.pause()\n}"
    },
    {
      "type": "text",
      "value": "**onStop()**"
    },
    {
      "type": "text",
      "value": "Activity больше не видна\n\nМесто для:\n\n- Отмены сетевых запросов\n\n- Отписки от событий"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onStop() {\n    super.onStop()\n    // Отмена работы с сенсорами\n    sensorManager.unregisterListener(this)\n    // Отписка от LiveData\n    liveData.removeObservers(this)\n}"
    },
    {
      "type": "text",
      "value": "**onDestroy()**"
    },
    {
      "type": "text",
      "value": "Финал жизненного цикла\n\nВызывается:\n\n- При явном вызове **finish()**\n\n- При уничтожении системой (например, нехватка памяти)\n\nОчистка всех ресурсов"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onDestroy() {\n    super.onDestroy()\n    // Освобождение ресурсов\n    camera.release()\n    // Отмена корутин\n    viewModel.cancelJobs()\n}"
    },
    {
      "type": "text",
      "value": "#### Сохранение состояния Activity:"
    },
    {
      "type": "text",
      "value": "**onSaveInstanceState()**\n\nВызывается перед возможным уничтожением (поворот экрана, выход из приложения):"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onSaveInstanceState(outState: Bundle) {\n    super.onSaveInstanceState(outState)\n    outState.putString(\"SAVED_TEXT\", editText.text.toString())\n    outState.putInt(\"SCROLL_POSITION\", recyclerView.computeVerticalScrollOffset())\n}"
    },
    {
      "type": "text",
      "value": "**Восстановление состояния:**"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "override fun onCreate(savedInstanceState: Bundle?) {\n    super.onCreate(savedInstanceState)\n    setContentView(R.layout.activity_main)\n    \n    if (savedInstanceState != null) {\n        val text = savedInstanceState.getString(\"SAVED_TEXT\")\n        val scrollPos = savedInstanceState.getInt(\"SCROLL_POSITION\")\n        editText.setText(text)\n        recyclerView.scrollTo(0, scrollPos)\n    }\n}"
    }
  ]
}