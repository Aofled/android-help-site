{
  "title": "Ленивая инициализация (by lazy)",
  "content": [
    {
      "type": "text",
      "value": "**by lazy** — это механизм **ленивой инициализации**, который позволяет отложить создание объекта до момента его первого использования. Это особенно полезно для ресурсоёмких операций или когда свойство не всегда требуется в работе программы."
    },
    {
      "type": "text",
      "value": "Свойство инициализируется при первом обращении к нему и затем кэшируется:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val heavyObject: HeavyResource by lazy {\n    println(\"Инициализация...\")\n    HeavyResource()  // Создаётся только здесь\n}\n\nfun main() {\n    println(\"До обращения\")\n    heavyObject.use()  // Инициализация... → Использование\n    heavyObject.use()  // Использование (повторной инициализации нет)\n}"
    },
    {
      "type": "text",
      "value": "Вывод:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "До обращения  \nИнициализация...  \nИспользование  \nИспользование"
    },
    {
      "type": "text",
      "value": "#### Ключевые особенности:"
    },
    {
      "type": "text",
      "value": "#### - Только для **val**. `by lazy` работает только с неизменяемыми свойствами (val), так как гарантирует единственную инициализацию."
    },
    {
      "type": "text",
      "value": "#### - Потокобезопасность. По умолчанию **lazy потокобезопасен** (используется **LazyThreadSafetyMode.SYNCHRONIZED**). Можно изменить режим:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val unsafeLazyValue: String by lazy(LazyThreadSafetyMode.NONE) {\n    \"Небезопасно для потоков\"\n}"
    },
    {
      "type": "text",
      "value": "#### - Инициализация при первом доступе\n\nВычисление происходит **один** раз, результат сохраняется и переиспользуется."
    },
    {
      "type": "text",
      "value": "#### Ограничения\n\n- Нельзя использовать для **локальных переменных** (только для свойств класса).\n\n\n\n- Не работает с **примитивами** (**Int**, **Boolean** и др.), если не обёрнуты в nullable-тип (**Int?**)."
    },
    {
      "type": "text",
      "value": "Пример:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class ImageLoader {\n    private val cachedImage by lazy { downloadImage() }  // Загрузится только при первом обращении\n\n    fun showImage() {\n        println(cachedImage)\n    }\n}"
    }
  ]
}