{
  "title": "Generics (обобщённые типы)",
  "content": [
    {
      "type": "text",
      "value": "`Generics (обобщённые типы)` — это механизм, который позволяет создавать классы, интерфейсы и функции, работающие с **разными типами данных**, сохраняя при этом **типобезопасность** на этапе компиляции."
    },
    {
      "type": "text",
      "value": "#### Простые Generics:"
    },
    {
      "type": "text",
      "value": "- Обобщённый класс"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class Box<T>(private var item: T) {\n    fun getItem(): T = item\n    fun setItem(newItem: T) { item = newItem }\n}\n\nval intBox = Box(42)          // Box<Int>\nval stringBox = Box(\"Kotlin\") // Box<String>"
    },
    {
      "type": "text",
      "value": "- Интерфейсы могут быть параметризованы:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "interface Repository<T> {\n    fun add(item: T)\n    fun get(id: Int): T?\n}\n\nclass UserRepository : Repository<User> {\n    private val users = mutableListOf<User>()\n    override fun add(item: User) { users.add(item) }\n    override fun get(id: Int): User? = users.find { it.id == id }\n}"
    },
    {
      "type": "text",
      "value": "- Generics в коллекциях:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val numbers: List<Int> = listOf(1, 2, 3)\nval names: MutableList<String> = mutableListOf(\"Alice\", \"Bob\")\n\n// Функции с generics:\nfun <T> filterList(list: List<T>, predicate: (T) -> Boolean): List<T> {\n    return list.filter(predicate)\n}\n\nval evenNumbers = filterList(numbers) { it % 2 == 0 }"
    },
    {
      "type": "text",
      "value": "- Обобщённая функция"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "fun <T> printItem(item: T) {\n    println(item)\n}\n\nprintItem(\"Hello\")  // Выведет \"Hello\"\nprintItem(10)       // Выведет 10"
    },
    {
      "type": "text",
      "value": "- Функция высшего порядка, аналогия **with**:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "inline fun<T> myWith(obj: T, operation: T.()-> Unit) {\n    return obj.operation()\n}"
    },
    {
      "type": "text",
      "value": "- Wildcards (* — звёздочка)"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "fun printItems(items: List<*>) {\n    items.forEach { println(it) }\n}\n\nprintItems(listOf(1, 2, 3))       // List<Int>\nprintItems(listOf(\"A\", \"B\", \"C\")) // List<String>"
    },
    {
      "type": "text",
      "value": "#### Ограничения типов (Upper Bounds).\n\nМожно указать, что `generic-тип` должен быть подтипом определённого класса/интерфейса:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "fun <T : Number> sum(a: T, b: T): Double {\n    return a.toDouble() + b.toDouble()\n}\n\nsum(5, 10)     // OK\nsum(3.14, 2.0) // OK\nsum(\"a\", \"b\")  // Ошибка: String не является Number"
    },
    {
      "type": "text",
      "value": "#### Вариантность (Variance)"
    },
    {
      "type": "text",
      "value": "- Инвариантность (**по умолчанию**)"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class Box<T>\nval box: Box<Number> = Box<Int>() // Ошибка: Box<Int> != Box<Number>"
    },
    {
      "type": "text",
      "value": "- Ковариантность (**out**)"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class Producer<out T>\nval producer: Producer<Number> = Producer<Int>() // OK"
    },
    {
      "type": "text",
      "value": "- Контравариантность (**in**)"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class Consumer<in T>\nval consumer: Consumer<Int> = Consumer<Number>() // OK"
    },
    {
      "type": "text",
      "value": "#### Примеры использования"
    },
    {
      "type": "text",
      "value": "- Обобщённые коллекции"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "val list: List<String> = listOf(\"a\", \"b\")\nval map: Map<Int, String> = mapOf(1 to \"one\")"
    },
    {
      "type": "text",
      "value": "- Кастомные generic-классы"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "class Triple<A, B, C>(val first: A, val second: B, val third: C)"
    },
    {
      "type": "text",
      "value": "- Функции-расширения"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "fun <T> List<T>.secondOrNull(): T? = if (size >= 2) this[1] else null"
    },
    {
      "type": "text",
      "value": "#### Общий пример:"
    },
    {
      "type": "code",
      "language": "kotlin",
      "value": "abstract class DataSource<T> {\n    abstract fun loadData(): List<T>\n}\n\nclass StringDataSource : DataSource<String>() {\n    override fun loadData(): List<String> = listOf(\"A\", \"B\", \"C\")\n}\n\nfun <T : Comparable<T>> findMax(items: List<T>): T? = items.maxOrNull()\n\nfun main() {\n    val dataSource = StringDataSource()\n    val items = dataSource.loadData()\n    println(findMax(items))  // \"C\"\n}"
    }
  ]
}